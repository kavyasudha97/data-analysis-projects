select * from dbo.books

-- 1.  Create a query that returns the longest title in the dataset.  
--We can do this in two steps.

-- A. Create a query that returns the length of the longest title. /*

select title, max(len(title)) AS longest_title from dbo.books ;

SELECT MAX(LEN(title)) AS Longest_Title FROM dbo.books

--B. Create a query that uses the length you found in step A to find the longest title.

SELECT title FROM dbo.books WHERE LEN(title) = 
(SELECT MAX(LEN(title))
    FROM dbo.books)


-- 2.  Use what you learned in question 1 to find the shortest author name.  

-- > A. Create a query that returns the length of the shortest author.
SELECT MIN(LEN(authors)) AS Longest_Title FROM dbo.books

--> B. Create a query that returns the shortest author's name.
SELECT Distinct authors FROM dbo.books WHERE LEN(authors) = 
(
    SELECT MIN(LEN(authors))
    FROM dbo.books
)

-- 3\. How many titles contain the word "The"?  

select title from dbo.books where title LIKE '%the%'

-- > A. Is there a difference between the number of titles that use "The" or "the"?
 select count(title) from dbo.books where title like '%the%'

 select count(title) from dbo.books where title like '%The%'

-- 4.  How many authors' names _start_ with 'Z'?

select count(authors) from dbo.books where authors like 'z%';

--5\. How many books have been identified as printed in a language other than English? 
-- There are four language codes for English: 'en', 'eng', 'en-US', and 'en-UK'.  
--Use LEFT to answer the question.  (Do not use the wildcard)
--You might want to use one of these 
--[comparison operators](https://docs.microsoft.com/en-us/sql/t-sql/language-elements/comparison-operators-transact-sql?view=sql-server-ver15).

SELECT COUNT(*) AS Non_Eng FROM dbo.books WHERE LEFT(language_code, 2) != 'en';

select  count(authors) from dbo.books where charindex('z',authors)=1 

-- 6\. Retry question 5 using SUBSTRING.

select count(*) as substring_count from dbo.books where SUBSTRING(language_code,1,2) !='en'

-- 7.  Create a column that returns the title, authors, and language codes.  
--Concatenate these elements so that they return in the following way: 
--title by authors in language\_code language.
--> A.  Check each selected column to see where any values are NULL.  
--Did any of the columns contain NULL values?  If so, which one?
select * from dbo.books
select title, authors, language_code from dbo.books
SELECT 
    CONCAT(title,' by ', authors,' in ', language_code,' \language') AS Book_summary
FROM dbo.books;

-- 8.  Update the query in question 7 using COALESCE to change the 
--language code values from NULL to 'unknown'.
-- > A.  Has this changed the language\_code  where the values are NULL?

SELECT 
    CONCAT(title,' by ', authors,' in ', coalesce(language_code,'unknown'), ' language') 
    AS Book_summary FROM dbo.books;

-- v9\. Revisit question 7 using ISNULL instead of COALESCE.

--> A.  Has this changed the language\_code  where the values are NULL?

SELECT 
    CONCAT(title,' by ', authors,' in ', ISNULL(language_code,'unknown'), ' language') 
    AS Book_summary FROM dbo.books;